#!/usr/bin/env ruby

require "base64"

chset64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
chsetSmiley="ðŸ˜€ðŸ˜ðŸ˜‚ðŸ˜ƒðŸ˜„ðŸ˜…ðŸ˜†ðŸ˜‰ðŸ˜ŠðŸ˜‹ðŸ˜ŽðŸ˜ðŸ˜˜ðŸ˜—ðŸ˜™ðŸ˜šðŸ™‚ðŸ¤—ðŸ¤”ðŸ˜ðŸ˜‘ðŸ˜¶ðŸ™„ðŸ˜ðŸ˜£ðŸ˜¥ðŸ˜®ðŸ¤ðŸ˜¯ðŸ˜ªðŸ˜«ðŸ˜´ðŸ˜ŒðŸ¤“ðŸ˜›ðŸ˜œðŸ˜ðŸ˜’ðŸ˜“ðŸ˜”ðŸ˜•ðŸ™ƒðŸ¤‘ðŸ˜²ðŸ™ðŸ˜–ðŸ˜žðŸ˜ŸðŸ˜¤ðŸ˜¢ðŸ˜­ðŸ˜¦ðŸ˜§ðŸ˜¨ðŸ˜©ðŸ˜¬ðŸ˜°ðŸ˜±ðŸ˜³ðŸ˜µðŸ˜¡ðŸ˜ ðŸ˜‡ðŸ˜·"

B64toSmile={}
SmileTo64={}

(0...64).each do |i|
  B64toSmile[chset64[i]] = chsetSmiley[i]
  SmileTo64[chsetSmiley[i]] = chset64[i]
end

def main()
  string = STDIN.read()
  if ARGV[0] == "-D"
    puts Base64.decode64(decode(string))
  else
    puts encode(Base64.encode64(string))
  end
end

def encode(string)
  string.split(//).map(&->c{B64toSmile[c]}).join
end

def decode(string)
  string.split(//).map(&->c{SmileTo64[c]}).join
end

main()
